
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Nilearn: Machine learning for NeuroImaging in Python &#8212; Machine learning for NeuroImaging</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.5.0a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.5.6. Simple example of NiftiMasker use" href="plot_nifti_simple.html" />
    <link rel="prev" title="8.5.4. Regions Extraction of Default Mode Networks using Smith Atlas" href="plot_extract_rois_smith_atlas.html" />
<meta content="True" name="HandheldFriendly">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
<meta name="keywords" content="nilearn, neuroimaging, python, neuroscience, machinelearning">
<script type="text/javascript">
$(function () {
    // Lock the table of content to a fixed position once we scroll enough
    var top = 105 + $('.sphinxsidebarwrapper').offset().top - parseFloat($('.sphinxsidebarwrapper').css('margin-top').replace(/auto/, 0)),
        sections = {},
        i        = 0,
	url	 = document.URL.replace(/#.*$/, ""),
	current_section = 0;

    // Grab positions of our sections
    $('.headerlink').each(function(){
        sections[this.href.replace(url, '')] = $(this).offset().top - 50;
    });

    $(window).scroll(function(event) {
	var pos   = $(window).scrollTop();
	// Lock the table of content to a fixed position once we scroll enough
	if(pos > top){
	    //begin to scroll
	    $('.sphinxsidebarwrapper').css("position", "fixed");
	    $('.sphinxsidebarwrapper').css("top", -105);
	}
	else{
	    //lock it back into place
	    $('.sphinxsidebarwrapper').css("position", "relative");
	    $('.sphinxsidebarwrapper').css("top",0);
	}

	// Highlight the current section
	$('a.internal').removeClass('active');
        for(i in sections){
            if(sections[i] > pos){
		break;
            }
            if($('a.internal[href$="' + i + '"]').is(':visible')){
		current_section = i;
        }
        }
	$('a.internal[href$="' + current_section + '"]').addClass('active');
    });

});
</script>


<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-41920728-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

  </head>
  <body>
<div id="logo-banner">
  <div class="logo">
    <a href="../../index.html">
      <img src="../../_static/nilearn-logo.png" alt="Nilearn logo"  border="0" />
    </a>
  </div>
  <!-- A tag cloud to make it easy for people to find what they are
                         looking for -->
 <div class="tags">
  <ul>
    <li>
      <big><a href="../decoding/plot_haxby_anova_svm.html">SVM</a></big>
    </li>
    <li>
      <small><a href="../../connectivity/parcellating.html">Ward
          clustering</a></small>
    </li>
    <li>
      <a href="../../decoding/searchlight.html">Searchlight</a>
    </li>
    <li>
      <big><a href="../../connectivity/resting_state_networks.html">ICA</a></big>
    </li>
    <li>
      <a href="../../manipulating_images/data_preparation.html">Nifti IO</a>
    </li>
    <li>
      <a href="../../modules/reference.html#module-nilearn.datasets">Datasets</a>
    </li>
  </ul>
 </div>

  <div class="banner">
    <h1>Nilearn:</h1>
    <h2>Machine learning for Neuro-Imaging in Python</h2>
  </div>
  <div class="search_form">
    <div class="gcse-search" id="cse" style="width: 100%;"></div>
    <script>
      (function() {
        var cx = '017289614950330089114:elrt9qoutrq';
        var gcse = document.createElement('script');
        gcse.type = 'text/javascript';
        gcse.async = true;
        gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(gcse, s);
      })();
    </script>
  </div>
</div>



    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_nifti_simple.html" title="8.5.6. Simple example of NiftiMasker use"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="plot_extract_rois_smith_atlas.html" title="8.5.4. Regions Extraction of Default Mode Networks using Smith Atlas"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Nilearn Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" accesskey="U">8. Nilearn usage examples</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">


<h4> Giving credit </h4>
  <ul class="simple">
    <li><p>Please consider <a href="../../authors.html#citing">citing the
                    papers</a>.</p></li>
  </ul>

  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">8.5.5. Breaking an atlas of labels in separated regions</a><ul>
<li><a class="reference internal" href="#the-original-yeo-atlas">8.5.5.1. The original Yeo atlas</a></li>
<li><a class="reference internal" href="#relabeling-the-atlas-into-separated-regions">8.5.5.2. Relabeling the atlas into separated regions</a></li>
<li><a class="reference internal" href="#different-connectivity-modes">8.5.5.3. Different connectivity modes</a></li>
<li><a class="reference internal" href="#parameter-min-size">8.5.5.4. Parameter min_size</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="plot_extract_rois_smith_atlas.html"
                        title="previous chapter">8.5.4. Regions Extraction of Default Mode Networks using Smith Atlas</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plot_nifti_simple.html"
                        title="next chapter">8.5.6. Simple example of NiftiMasker use</a></p>

<div class="navbar">
</div> <!-- end navbar -->

<script type="text/javascript">$('#searchbox-ml').show(0);</script>
<script type="text/javascript">$('#searchbox-site').show(0);</script>


        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="breaking-an-atlas-of-labels-in-separated-regions">
<span id="sphx-glr-auto-examples-04-manipulating-images-plot-extract-regions-labels-image-py"></span><h1>8.5.5. Breaking an atlas of labels in separated regions<a class="headerlink" href="#breaking-an-atlas-of-labels-in-separated-regions" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to use
<a class="reference internal" href="../../modules/generated/nilearn.regions.connected_label_regions.html#nilearn.regions.connected_label_regions" title="nilearn.regions.connected_label_regions"><code class="xref py py-class docutils literal"><span class="pre">nilearn.regions.connected_label_regions</span></code></a>
to assign each spatially-separated region of the atlas a unique label.</p>
<p>Indeed, often in a given atlas of labels, the same label (number) may
be used in different connected regions, for instance a region in each
hemisphere. If we want to operate on regions and not networks (for
instance in signal extration), it is useful to assign a different
label to each region. We end up with a new atlas that has more labels,
but each one points to a single region.</p>
<p>We use the Yeo atlas as an example for labeling regions,
<a class="reference internal" href="../../modules/generated/nilearn.datasets.fetch_atlas_yeo_2011.html#nilearn.datasets.fetch_atlas_yeo_2011" title="nilearn.datasets.fetch_atlas_yeo_2011"><code class="xref py py-func docutils literal"><span class="pre">nilearn.datasets.fetch_atlas_yeo_2011</span></code></a></p>
<div class="section" id="the-original-yeo-atlas">
<h2>8.5.5.1. The original Yeo atlas<a class="headerlink" href="#the-original-yeo-atlas" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># First we fetch the Yeo atlas</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">datasets</span>

<span class="n">atlas_yeo_2011</span> <span class="o">=</span> <a href="../../modules/generated/nilearn.datasets.fetch_atlas_yeo_2011.html#nilearn.datasets.fetch_atlas_yeo_2011" title="View documentation for nilearn.datasets.fetch_atlas_yeo_2011"><span class="n">datasets</span><span class="o">.</span><span class="n">fetch_atlas_yeo_2011</span></a><span class="p">()</span>
<span class="n">atlas_yeo</span> <span class="o">=</span> <span class="n">atlas_yeo_2011</span><span class="o">.</span><span class="n">thick_7</span>

<span class="c1"># Let&#39;s now plot it</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span>

<a href="../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi" title="View documentation for nilearn.plotting.plot_roi"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span></a><span class="p">(</span><span class="n">atlas_yeo</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Original Yeo atlas&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_extract_regions_labels_image_001.png" class="align-center" src="../../_images/sphx_glr_plot_extract_regions_labels_image_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-default"><div class="highlight"><pre><span></span><span class="n">Downloading</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">surfer</span><span class="o">.</span><span class="n">nmr</span><span class="o">.</span><span class="n">mgh</span><span class="o">.</span><span class="n">harvard</span><span class="o">.</span><span class="n">edu</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">Yeo_JNeurophysiol11_MNI152</span><span class="o">.</span><span class="n">zip</span> <span class="o">...</span>
</pre></div>
</div>
<p>The original Yeo atlas has 7 labels, that is indicated in the colorbar.
The colorbar also shows the correspondence between the color and the label</p>
<p>Note that these 7 labels correspond actually to networks that comprise
several regions. We are going to split them up.</p>
</div>
<div class="section" id="relabeling-the-atlas-into-separated-regions">
<h2>8.5.5.2. Relabeling the atlas into separated regions<a class="headerlink" href="#relabeling-the-atlas-into-separated-regions" title="Permalink to this headline">¶</a></h2>
<p>Now we use the connected_label_regions to break appart the networks
of the Yeo atlas into separated regions</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">nilearn.regions</span> <span class="kn">import</span> <a href="../../modules/generated/nilearn.regions.connected_label_regions.html#nilearn.regions.connected_label_regions" title="View documentation for nilearn.regions.connected_label_regions"><span class="n">connected_label_regions</span></a>
<span class="n">region_labels</span> <span class="o">=</span> <a href="../../modules/generated/nilearn.regions.connected_label_regions.html#nilearn.regions.connected_label_regions" title="View documentation for nilearn.regions.connected_label_regions"><span class="n">connected_label_regions</span></a><span class="p">(</span><span class="n">atlas_yeo</span><span class="p">)</span>
</pre></div>
</div>
<p>Plotting the new regions</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><a href="../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi" title="View documentation for nilearn.plotting.plot_roi"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span></a><span class="p">(</span><span class="n">region_labels</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Relabeled Yeo atlas&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_extract_regions_labels_image_002.png" class="align-center" src="../../_images/sphx_glr_plot_extract_regions_labels_image_002.png" />
<p>Note that the same cluster in original and labeled atlas could have
different color, so, you cannot directly compare colors.</p>
<p>However, you can see that the regions in the left and right hemispheres
now have different colors. For some regions it is difficult to tell
appart visually, as the colors are too close on the colormap (eg in the
blue: regions labeled around 3).</p>
<p>Also, we can see that there are many more labels: the colorbar goes up
to 49. The 7 networks of the Yeo atlas are now broken up into 49
ROIs.</p>
<p>You can save the new atlas to a nifti file using to_filename method.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">region_labels</span><span class="o">.</span><span class="n">to_filename</span><span class="p">(</span><span class="s1">&#39;relabeled_yeo_atlas.nii.gz&#39;</span><span class="p">)</span>

<span class="c1"># The images are saved to the current folder. It is possible to specify the</span>
<span class="c1"># folder for saving the results, i.e.</span>
<span class="c1"># import os</span>
<span class="c1"># region_labels.to_filename(os.path.join(folder_path,</span>
<span class="c1">#                                        &#39;relabeled_yeo_atlas.nii.gz&#39;))</span>
</pre></div>
</div>
</div>
<div class="section" id="different-connectivity-modes">
<h2>8.5.5.3. Different connectivity modes<a class="headerlink" href="#different-connectivity-modes" title="Permalink to this headline">¶</a></h2>
<p>Using the parameter connect_diag=False we separate in addition two regions
that are connected only along the diagonal.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">region_labels_not_diag</span> <span class="o">=</span> <a href="../../modules/generated/nilearn.regions.connected_label_regions.html#nilearn.regions.connected_label_regions" title="View documentation for nilearn.regions.connected_label_regions"><span class="n">connected_label_regions</span></a><span class="p">(</span><span class="n">atlas_yeo</span><span class="p">,</span>
                                                 <span class="n">connect_diag</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<a href="../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi" title="View documentation for nilearn.plotting.plot_roi"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span></a><span class="p">(</span><span class="n">region_labels_not_diag</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Relabeling and connect_diag=False&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_extract_regions_labels_image_003.png" class="align-center" src="../../_images/sphx_glr_plot_extract_regions_labels_image_003.png" />
<p>A consequence of using connect_diag=False is that we can get a lot of
small regions, around 110 judging from the colorbar.</p>
<p>Hence we suggest use connect_diag=True</p>
</div>
<div class="section" id="parameter-min-size">
<h2>8.5.5.4. Parameter min_size<a class="headerlink" href="#parameter-min-size" title="Permalink to this headline">¶</a></h2>
<p>In the above, we get around 110 regions, but many of these are very
small. We can remove them with the min_size parameter, keeping only the
regions larger than 100mm^3.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">region_labels_min_size</span> <span class="o">=</span> <a href="../../modules/generated/nilearn.regions.connected_label_regions.html#nilearn.regions.connected_label_regions" title="View documentation for nilearn.regions.connected_label_regions"><span class="n">connected_label_regions</span></a><span class="p">(</span><span class="n">atlas_yeo</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                                 <span class="n">connect_diag</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<a href="../../modules/generated/nilearn.plotting.plot_roi.html#nilearn.plotting.plot_roi" title="View documentation for nilearn.plotting.plot_roi"><span class="n">plotting</span><span class="o">.</span><span class="n">plot_roi</span></a><span class="p">(</span><span class="n">region_labels_min_size</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Relabeling and min_size&#39;</span><span class="p">,</span>
                  <span class="n">cut_coords</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Paired&#39;</span><span class="p">)</span>

<a href="../../modules/generated/nilearn.plotting.show.html#nilearn.plotting.show" title="View documentation for nilearn.plotting.show"><span class="n">plotting</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_extract_regions_labels_image_004.png" class="align-center" src="../../_images/sphx_glr_plot_extract_regions_labels_image_004.png" />
<p><strong>Total running time of the script:</strong> ( 0 minutes  35.887 seconds)</p>
<div class="sphx-glr-footer docutils container">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_extract_regions_labels_image.py" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_extract_regions_labels_image.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" href="../../_downloads/plot_extract_regions_labels_image.ipynb" download=""><code class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_extract_regions_labels_image.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io">Generated by Sphinx-Gallery</a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a></li>
        <li class="right" >
          <a href="plot_nifti_simple.html" title="8.5.6. Simple example of NiftiMasker use"
             >next</a> |</li>
        <li class="right" >
          <a href="plot_extract_rois_smith_atlas.html" title="8.5.4. Regions Extraction of Default Mode Networks using Smith Atlas"
             >previous</a> |</li>
<li><a href="../../index.html">Nilearn Home</a> |&nbsp;</li>
<li><a href="../../user_guide.html">User Guide</a> |&nbsp;</li>
<li><a href="../index.html">Examples</a> |&nbsp;</li>
<li><a href="../../modules/reference.html">Reference</a> |&nbsp;</li>
<li id="navbar-about"><a href="../../authors.html">About</a>|&nbsp;</li>
<li id="navbar-ecosystem"><a href="http://www.nipy.org/">Nipy ecosystem</a></li>

          <li class="nav-item nav-item-1"><a href="../../user_guide.html" >User guide: table of contents</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >8. Nilearn usage examples</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
            &copy; The nilearn developers 2010-2015.
          Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.7.
        <span style="padding-left: 5ex;">
          <a href="../../_sources/auto_examples/04_manipulating_images/plot_extract_regions_labels_image.rst.txt"
        	 rel="nofollow">Show this page source</a>
        </span>
    </div>
  </body>
</html>