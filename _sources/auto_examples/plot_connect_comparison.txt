

.. _example_nilearn_plot_connect_comparison.py:


Estimation of precision matrices in sparse gaussian graphical models
====================================================================

This example shows a comparison of graph lasso and group-sparse covariance
estimates for a synthetic dataset.



.. image:: images/plot_connect_comparison_1.png
    :align: center


**Python source code:** :download:`plot_connect_comparison.py <plot_connect_comparison.py>`

.. literalinclude:: plot_connect_comparison.py
    :lines: 8-

**Script output**::

  [generate_group_sparse_gaussian_graphs] Sparsity: 0.220000
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 0.000e+00
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 7.226e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 8.945e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 7.196e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 0.000e+00
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 7.415e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.099e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 1.677e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 4: 1.968e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 0.000e+00
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 7.393e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.211e-01  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 7.615e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  1 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.907e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.687e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 4.087e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 2.185e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.568e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.645e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.443e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 6.487e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.845e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.660e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  2 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.970e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.127e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.099e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.649e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.112e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.060e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.480e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 1.455e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.974e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.153e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.101e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  3 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 5.168e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.946e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 4.942e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 8.165e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 5.732e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.863e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 3.928e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 5.249e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.038e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 3.322e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.033e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.068e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  4 out of 4
  [GroupSparseCovarianceCV.fit] Final optimization
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 4.718e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.130e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 4.043e-03  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 4: 2.494e-04
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   1s
  [GraphLassoCV] Done refinement  4 out of 4:   1s
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   1s
  [GraphLassoCV] Done refinement  4 out of 4:   1s
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   1s
  [GraphLassoCV] Done refinement  4 out of 4:   1s
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   0s
  [GraphLassoCV] Done refinement  4 out of 4:   1s



**Total running time of the example:**  30.24 seconds
    