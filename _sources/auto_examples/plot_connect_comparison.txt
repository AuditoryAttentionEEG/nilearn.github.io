

.. _example_plot_connect_comparison.py:


Sparse inverse covariance estimation
=====================================

This example shows a comparison of graph lasso and group-sparse covariance
estimates for a synthetic dataset.



.. image:: images/plot_connect_comparison_1.png
    :align: center


**Script output**:

.. rst-class:: max_height

 ::

    [generate_group_sparse_gaussian_graphs] Sparsity: 0.220000
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 0.000e+00
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 7.226e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 9.148e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 8.550e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 0.000e+00
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 7.415e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.080e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 1.540e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 4: 1.837e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 1: 0.000e+00
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 7.267e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  1 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.907e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.720e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 4.080e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 2.520e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.568e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.607e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 5.845e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 5.607e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.825e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.688e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  2 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.970e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.132e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.131e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.214e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 7.339e-04
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.649e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.103e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.671e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 1.041e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.059e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 1.371e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 1.242e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.927e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.163e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 1.105e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  3 out of 4
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 5.168e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.974e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 3.719e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.163e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 3.624e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 4.942e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 7.103e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 3: 4.788e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.857e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 3.709e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 2.832e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 3.558e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 5.167e-01  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.090e-02  ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 1
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 3.051e-02  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 2: 3.690e-03
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] Log-likelihood on test set is decreasing. Stopping at iteration 0
  [GroupSparseCovarianceCV.fit] [GroupSparseCovarianceCV] Done refinement  4 out of 4
  [GroupSparseCovarianceCV.fit] Final optimization
  [GroupSparseCovarianceCV.fit] * iteration 0 (0 %) ...
  [GroupSparseCovarianceCV.fit] * iteration 1 (2 %) variation (max norm): 4.805e-01  ...
  [GroupSparseCovarianceCV.fit] * iteration 2 (4 %) variation (max norm): 6.364e-02  ...
  [GroupSparseCovarianceCV.fit] * iteration 3 (6 %) variation (max norm): 4.586e-03  ...
  [GroupSparseCovarianceCV.fit] tolerance reached at iteration number 4: 2.879e-04
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   0s
  [GraphLassoCV] Done refinement  4 out of 4:   0s
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   0s
  [GraphLassoCV] Done refinement  4 out of 4:   0s
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   0s
  [GraphLassoCV] Done refinement  4 out of 4:   0s
  [GraphLassoCV] Done refinement  1 out of 4:   0s
  [GraphLassoCV] Done refinement  2 out of 4:   0s
  [GraphLassoCV] Done refinement  3 out of 4:   0s
  [GraphLassoCV] Done refinement  4 out of 4:   0s



**Python source code:** :download:`plot_connect_comparison.py <plot_connect_comparison.py>`

.. literalinclude:: plot_connect_comparison.py
    :lines: 8-

**Total running time of the example:**  6.62 seconds 
( 0 minutes  6.62 seconds)
    