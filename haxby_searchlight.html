

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.3. Searchlight : finding voxels containing maximum information &mdash; NeuroImaging with the scikit-learn</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '2010',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="NeuroImaging with the scikit-learn" href="index.html" />
    <link rel="up" title="3. Supervised learning" href="supervised_learning.html" />
    <link rel="next" title="4. Unsupervised learning" href="unsupervised_learning.html" />
    <link rel="prev" title="3.2. fMRI decoding: predicting which objects a subject is viewing" href="haxby_decoding.html" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22606712-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>

    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="index.html">
            <img src="_static/scikit-learn-logo-small.png" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
          
	    <li><a href="visualization.html">Data Manipulation</a></li>
            <li><a href="supervised_learning.html">Supervised Learning</a></li>
            <li><a href="unsupervised_learning.html">Unsupervised Learning</a></li>
            <li><a href="auto_examples/index.html">Examples</a></li>
          
	  
       </ul>

<div class="search_form">

<div id="cse" style="width: 100%;"></div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript">
  google.load('search', '1', {language : 'en'});
  google.setOnLoadCallback(function() {
    var customSearchControl = new google.search.CustomSearchControl('016639176250731907682:tjtqbvtvij0');
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    var options = new google.search.DrawOptions();
    options.setAutoComplete(true);
    customSearchControl.draw('cse', options);
  }, true);
</script>

</div>
          </div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

      <div class="sphinxsidebar">
	<div class="sphinxsidebarwrapper">
	  <div class="rel">
	   
	<!-- XXX: when we have a 'module index' that appears in the link
	     bar, we will need to use the following ugly hack to avoid it
	     rellinks[1:]|reverse
	    -->
	<div class="rellink">
	<a href="haxby_decoding.html" title="3.2. fMRI decoding: predicting which objects a subject is viewing"
	    accesskey="P">Previous
	    <br>
	    <span class="smallrellink">
	    3.2. fMRI decodi...
	    </span>
	    <span class="hiddenrellink">
	    3.2. fMRI decoding: predicting which objects a subject is viewing
	    </span>
	    
	    </a>
	</div>
	    <div class="spacer">
	    &nbsp;
	    </div>
	
	<div class="rellink">
	<a href="unsupervised_learning.html" title="4. Unsupervised learning"
	    accesskey="N">Next
	    <br>
	    <span class="smallrellink">
	    4. Unsupervised ...
	    </span>
	    <span class="hiddenrellink">
	    4. Unsupervised learning
	    </span>
	    
	    </a>
	</div>
	<!-- Ad a link to the 'up' page -->
	<div class="spacer">
	&nbsp;
	</div>
	<div class="rellink">
	<a href="supervised_learning.html" title="3. Supervised learning" >
	Up
	<br>
	<span class="smallrellink">
	3. Supervised le...
	</span>
	<span class="hiddenrellink">
	3. Supervised learning
	</span>
	
	</a>
	</div>
    </div>
    <h3>This page</h3>
	<ul>
<li><a class="reference internal" href="#">3.3. Searchlight : finding voxels containing maximum information</a><ul>
<li><a class="reference internal" href="#searchlight-principle">3.3.1. Searchlight principle</a></li>
<li><a class="reference internal" href="#preprocessing">3.3.2. Preprocessing</a><ul>
<li><a class="reference internal" href="#loading">3.3.2.1. Loading</a></li>
<li><a class="reference internal" href="#preparing-data">3.3.2.2. Preparing data</a></li>
<li><a class="reference internal" href="#masking">3.3.2.3. Masking</a></li>
<li><a class="reference internal" href="#restricting-the-dataset">3.3.2.4. Restricting the dataset</a></li>
</ul>
</li>
<li><a class="reference internal" href="#third-step-set-up-the-cross-validation">3.3.3. Third Step : Set up the cross validation</a><ul>
<li><a class="reference internal" href="#classifier">3.3.3.1. Classifier</a></li>
<li><a class="reference internal" href="#score-function">3.3.3.2. Score function</a></li>
<li><a class="reference internal" href="#cross-validation">3.3.3.3. Cross validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-searchlight">3.3.4. Running Searchlight</a></li>
<li><a class="reference internal" href="#visualisation">3.3.5. Visualisation</a><ul>
<li><a class="reference internal" href="#id1">3.3.5.1. Searchlight</a></li>
<li><a class="reference internal" href="#f-score">3.3.5.2. F_score</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    
    </div>
	  </div>


      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="searchlight-finding-voxels-containing-maximum-information">
<span id="searchlight"></span><h1>3.3. Searchlight : finding voxels containing maximum information<a class="headerlink" href="#searchlight-finding-voxels-containing-maximum-information" title="Permalink to this headline">¶</a></h1>
<div class="section" id="searchlight-principle">
<h2>3.3.1. Searchlight principle<a class="headerlink" href="#searchlight-principle" title="Permalink to this headline">¶</a></h2>
<p>Searchlight was introduced in <a class="reference external" href="http://www.pnas.org/content/103/10/3863">Information-based functional brain mapping</a>, Nikolaus Kriegeskorte,
Rainer Goebel and Peter Bandettini (PNAS 2006) and consists in scanning the
images volume with a <em>searchlight</em>. It can basically be related to mathematical
morphology in the sense that a structuring element will be used to iterate over
a 3D volume. But, instead of applying a mathematical operator (like minimum for
erosion or maximum for dilatation), we will run a classifier on the <em>floodlit</em>
voxels and score them (using cross validation). This gives us an
<em>information-based functional brain mapping</em>.</p>
</div>
<div class="section" id="preprocessing">
<h2>3.3.2. Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading">
<h3>3.3.2.1. Loading<a class="headerlink" href="#loading" title="Permalink to this headline">¶</a></h3>
<p>As seen in previous tutorial, this is rather easy thanks to <em>nisl</em> dataset
manager.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nisl</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_haxby</span><span class="p">()</span>
<span class="n">fmri_data</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">mask</span>
<span class="n">affine</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">affine</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target_strings</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">session</span>
</pre></div>
</div>
</div>
<div class="section" id="preparing-data">
<h3>3.3.2.2. Preparing data<a class="headerlink" href="#preparing-data" title="Permalink to this headline">¶</a></h3>
<p>For this tutorial we need:</p>
<ul class="simple">
<li>to put X in the form <em>n_samples</em> x <em>n_features</em></li>
<li>compute a mean image for visualisation background</li>
<li>detrend the data</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c"># Change axis in order to have X under n_samples * x * y * z</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rollaxis</span><span class="p">(</span><span class="n">fmri_data</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="c"># X.shape is (1452, 41, 40, 49)</span>

<span class="c"># Mean image: used as background in visualisation</span>
<span class="n">mean_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c"># Detrend data on each session independently</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">X</span><span class="p">[</span><span class="n">session</span> <span class="o">==</span> <span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">session</span> <span class="o">==</span> <span class="n">s</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="masking">
<h3>3.3.2.3. Masking<a class="headerlink" href="#masking" title="Permalink to this headline">¶</a></h3>
<p>One of the main element that distinguich Searchlight from other algorithms is
this notion of structuring element that scan the entire volume. If this seems
rather intuitive, it has in fact an impact on the masking procedure.</p>
<p>Most of the time, fMRI data is masked and then given to the algorithm. This is
not possible in the case of Searchlight because, to compute the score of
non-masked voxels, some masked voxels may be needed. This is why two masks will
be used here :</p>
<ul class="simple">
<li><em>mask</em> is the anatomical mask</li>
<li><em>process_mask</em> is a subset of mask and contains voxels to be processed.</li>
</ul>
<p><em>process_mask</em> will then be used to restrain computation to one slice, in the
back of the brain. <em>mask</em> will ensure that no value outside of the brain is
taken into account when iterating with the sphere.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">mask</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">process_mask</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">process_mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">27</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">process_mask</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">process_mask</span><span class="p">[:,</span> <span class="mi">23</span><span class="p">:]</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
</div>
<div class="section" id="restricting-the-dataset">
<h3>3.3.2.4. Restricting the dataset<a class="headerlink" href="#restricting-the-dataset" title="Permalink to this headline">¶</a></h3>
<p>Like <em>haxby_decoding</em> example, we limit our analysis to the <cite>face</cite> and <cite>house</cite> conditions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Keep only data corresponding to face or houses</span>
<span class="n">condition_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">conditions</span> <span class="o">==</span> <span class="s">&#39;face&#39;</span><span class="p">,</span> <span class="n">conditions</span> <span class="o">==</span> <span class="s">&#39;house&#39;</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">condition_mask</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">condition_mask</span><span class="p">]</span>
<span class="n">session</span> <span class="o">=</span> <span class="n">session</span><span class="p">[</span><span class="n">condition_mask</span><span class="p">]</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">[</span><span class="n">condition_mask</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="third-step-set-up-the-cross-validation">
<h2>3.3.3. Third Step : Set up the cross validation<a class="headerlink" href="#third-step-set-up-the-cross-validation" title="Permalink to this headline">¶</a></h2>
<p>Searchlight will iterate on the volume and give a score to each voxel. This
score is computed by running a classifier on selected voxels. In order to make
this score as accurate as possible (and avoid overfitting), a cross validation
is made.</p>
<div class="section" id="classifier">
<h3>3.3.3.1. Classifier<a class="headerlink" href="#classifier" title="Permalink to this headline">¶</a></h3>
<p>The classifier used by default by Searchlight is LinearSVC with C=1 but this
can be customed easily by passing an estimator parameter to the cross
validation.</p>
<p>See scikit-learn documentation for
<a class="reference external" href="http://scikit-learn.org/supervised_learning.html">other classifiers</a></p>
</div>
<div class="section" id="score-function">
<h3>3.3.3.2. Score function<a class="headerlink" href="#score-function" title="Permalink to this headline">¶</a></h3>
<p>Here we use precision as metrics to measures proportion of true
positives among all positives results for one class.</p>
<p>Many others are available in <a class="reference external" href="http://scikit-learn.org/supervised_learning.html">scikit-learn documentation</a></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span>
<span class="n">score_func</span> <span class="o">=</span> <span class="n">precision_score</span>
</pre></div>
</div>
</div>
<div class="section" id="cross-validation">
<h3>3.3.3.3. Cross validation<a class="headerlink" href="#cross-validation" title="Permalink to this headline">¶</a></h3>
<p>As Searchlight is a little costly, we have chosen a cross validation method
that do not take too much time. <em>K</em>-Fold along with <em>K</em> = 4 is a good compromise
between running time and result.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-searchlight">
<h2>3.3.4. Running Searchlight<a class="headerlink" href="#running-searchlight" title="Permalink to this headline">¶</a></h2>
<p>Running Searchlight is straightforward now that everything is set. The only
parameter left is the radius of the ball that will run through the data.
Kriegskorte uses a 4mm radius because it yielded the best detection
performance in his simulation.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">nisl</span> <span class="kn">import</span> <span class="n">searchlight</span>

<span class="c"># The radius is the one of the Searchlight sphere that will scan the volume</span>
<span class="n">searchlight</span> <span class="o">=</span> <span class="n">searchlight</span><span class="o">.</span><span class="n">SearchLight</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">process_mask</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">score_func</span><span class="o">=</span><span class="n">score_func</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>

<span class="c"># scores.scores_ is an array containing per voxel cross validation scores</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">searchlight</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="visualisation">
<h2>3.3.5. Visualisation<a class="headerlink" href="#visualisation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>3.3.5.1. Searchlight<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>As the activation map is cropped, we use the mean image of all scans as a
background. We can see here that voxels in the visual cortex contains
information to distinguish pictures showed to the volunteer, which was the
expected result.</p>
<div class="figure align-center">
<a class="reference external image-reference" href="auto_examples/plot_haxby_searchlight.html"><img alt="_images/plot_haxby_searchlight_1.png" src="_images/plot_haxby_searchlight_1.png" style="width: 480.0px; height: 360.0px;" /></a>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">pl</span>
<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">s_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">scores_</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">process_mask</span><span class="p">))</span>
<span class="n">pl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">mean_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">26</span><span class="p">]),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">s_scores</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">26</span><span class="p">]),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="f-score">
<h3>3.3.5.2. F_score<a class="headerlink" href="#f-score" title="Permalink to this headline">¶</a></h3>
<p>Another commonly used algorithm to find salient voxel is the ANOVA (analysis of
variance). Here we use is to compute the <em>p_values</em> of the voxels. The
<em>p_value</em> is the probability of getting the observed values assuming that
nothing happens (i.e. the null hypothesis is true). Therefore, a small
<em>p-value</em> indicates that there is a small chance of getting this data if no
real difference existed, so the observed voxel must be significant.</p>
<p>As the policy &#8220;the smaller, the better&#8221; is not very intuitive, we use the log
and negate the result to obtain a more comprehensive map.</p>
<div class="figure align-center">
<a class="reference external image-reference" href="auto_examples/plot_haxby_searchlight.html"><img alt="_images/plot_haxby_searchlight_2.png" src="_images/plot_haxby_searchlight_2.png" style="width: 480.0px; height: 360.0px;" /></a>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">f_classif</span>
<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_masked</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="n">process_mask</span><span class="p">]</span>
<span class="n">f_values</span><span class="p">,</span> <span class="n">p_values</span> <span class="o">=</span> <span class="n">f_classif</span><span class="p">(</span><span class="n">X_masked</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p_values</span><span class="p">)</span>
<span class="n">p_values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">p_values</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p_values</span><span class="p">[</span><span class="n">p_values</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p_unmasked</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">p_unmasked</span><span class="p">[</span><span class="n">process_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">p_values</span>
<span class="n">p_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">p_unmasked</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">process_mask</span><span class="p">))</span>
<span class="n">pl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">mean_img</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">26</span><span class="p">]),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">p_ma</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">26</span><span class="p">]),</span> <span class="n">interpolation</span><span class="o">=</span><span class="s">&#39;nearest&#39;</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">pl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>
  

    <div class="footer">
        &copy; INRIA Parietal 2010.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3. Design by <a href="http://webylimonada.com">Web y Limonada</a>.
    <span style="padding-left: 5ex;">
    <a href="_sources/haxby_searchlight.txt"
	    rel="nofollow">Show this page source</a>
    </span>
    </div>
     <div class="rel">
    
	<!-- XXX: when we have a 'module index' that appears in the link
	     bar, we will need to use the following ugly hack to avoid it
	rellinks[1:]|reverse
	-->
    <div class="buttonPrevious">
      <a href="haxby_decoding.html">
        Previous
      </a>  
    </div>
    <div class="buttonNext">
      <a href="unsupervised_learning.html">
        Next
      </a>  
    </div>
    
     </div>
     <script type="text/javascript">
       $("div.buttonNext, div.buttonPrevious").hover(
           function () {
               $(this).css('background-color', '#FF9C34');
           },
           function () {
               $(this).css('background-color', '#A7D6E2');
           }
       );
     </script>
  </body>
</html>